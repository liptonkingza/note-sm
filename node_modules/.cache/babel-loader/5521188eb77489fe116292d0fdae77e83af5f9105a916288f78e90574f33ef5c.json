{"ast":null,"code":"import _objectSpread from\"C:/Users/lipto/Desktop/react/smart-note-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useMemo}from\"react\";import{initializeApp}from\"firebase/app\";import{getFirestore,collection,addDoc,updateDoc,deleteDoc,doc,onSnapshot,query,orderBy,serverTimestamp,Timestamp,arrayUnion}from\"firebase/firestore\";import{getAuth,signInAnonymously,onAuthStateChanged}from\"firebase/auth\";import{Pencil,Save,Trash2,Search,Calendar,Sparkles,Plus,X,Loader2,Bot,Maximize2,Minimize2,Clock,Check,Users,LogOut,KeyRound,AlertCircle}from\"lucide-react\";// --- à¸ªà¹ˆà¸§à¸™à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² (à¸•à¹‰à¸­à¸‡à¹à¸à¹‰à¹„à¸‚à¸•à¸£à¸‡à¸™à¸µà¹‰à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸ˆà¸£à¸´à¸‡) ---\n// 1. à¹„à¸›à¸—à¸µà¹ˆ console.firebase.google.com à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œà¹ƒà¸«à¸¡à¹ˆ\n// 2. à¸ªà¸£à¹‰à¸²à¸‡ Web App à¹à¸¥à¸°à¸à¹Šà¸­à¸›à¸›à¸µà¹‰à¸„à¹ˆà¸² config à¸¡à¸²à¹ƒà¸ªà¹ˆà¹à¸—à¸™à¸—à¸µà¹ˆà¸•à¸£à¸‡à¸™à¸µà¹‰à¸„à¸£à¸±à¸š\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const firebaseConfig={apiKey:\"AIzaSyBC2seZeDwSnzQv74OxfUap3IilWZi2oUA\",// à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\nauthDomain:\"zoom-smart-note.firebaseapp.com\",// à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\nprojectId:\"zoom-smart-note\",// à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\nstorageBucket:\"zoom-smart-note.firebasestorage.app\",// à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\nmessagingSenderId:\"391568270505\",// à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\nappId:\"1:391568270505:web:f523347b05de36288df5b8\"// à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\n};// --- API Key à¸‚à¸­à¸‡ Gemini AI (à¹ƒà¸ªà¹ˆà¸•à¸£à¸‡à¸™à¸µà¹‰) ---\n// à¹„à¸›à¸‚à¸­à¸Ÿà¸£à¸µà¹„à¸”à¹‰à¸—à¸µà¹ˆ aistudio.google.com\nconst GEMINI_API_KEY=\"AIzaSyCH7dU_lGn71g2m0zQuk4flmcyp8QfPqk0\";// --- à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸£à¸°à¸šà¸š ---\nconst isConfigured=firebaseConfig.apiKey&&!firebaseConfig.apiKey.includes(\"AIzaSy...\");let app,auth,db;if(isConfigured){try{app=initializeApp(firebaseConfig);auth=getAuth(app);db=getFirestore(app);}catch(e){console.error(\"Firebase Init Error:\",e);}}const appId=\"smart-note-production\";// --- AI Service ---\nconst callGeminiAI=async text=>{if(!GEMINI_API_KEY){alert(\"à¸à¸£à¸¸à¸“à¸²à¹ƒà¸ªà¹ˆ GEMINI_API_KEY à¹ƒà¸™à¹‚à¸„à¹‰à¸”à¸à¹ˆà¸­à¸™à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ AI à¸„à¸£à¸±à¸š\");return[{title:\"AI Setup Needed\",category:\"à¸—à¸±à¹ˆà¸§à¹„à¸›\",summary:\"Please configure API Key\"}];}const systemPrompt=\"\\n    Role: \\u0E04\\u0E38\\u0E13\\u0E04\\u0E37\\u0E2D\\u0E40\\u0E25\\u0E02\\u0E32\\u0E2D\\u0E31\\u0E08\\u0E09\\u0E23\\u0E34\\u0E22\\u0E30\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E15\\u0E31\\u0E27\\n    Task: \\u0E27\\u0E34\\u0E40\\u0E04\\u0E23\\u0E32\\u0E30\\u0E2B\\u0E4C\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\\u0E14\\u0E34\\u0E1A\\u0E41\\u0E25\\u0E49\\u0E27 \\\"\\u0E41\\u0E22\\u0E01\\u0E2B\\u0E31\\u0E27\\u0E02\\u0E49\\u0E2D\\\" (Split Topics)\\n    Instructions:\\n    1. \\u0E41\\u0E22\\u0E01\\u0E1B\\u0E23\\u0E30\\u0E40\\u0E14\\u0E47\\u0E19\\u0E43\\u0E19\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\\u0E2D\\u0E2D\\u0E01\\u0E40\\u0E1B\\u0E47\\u0E19\\u0E42\\u0E19\\u0E49\\u0E15\\u0E22\\u0E48\\u0E2D\\u0E22\\u0E46\\n    2. \\u0E41\\u0E15\\u0E48\\u0E25\\u0E30\\u0E42\\u0E19\\u0E49\\u0E15\\u0E15\\u0E49\\u0E2D\\u0E07\\u0E21\\u0E35 format:\\n       - \\\"title\\\": \\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E40\\u0E23\\u0E37\\u0E48\\u0E2D\\u0E07 (\\u0E44\\u0E21\\u0E48\\u0E40\\u0E01\\u0E34\\u0E19 10 \\u0E04\\u0E33)\\n       - \\\"category\\\": \\u0E40\\u0E25\\u0E37\\u0E2D\\u0E01\\u0E08\\u0E32\\u0E01 [\\\"\\u0E1B\\u0E23\\u0E30\\u0E0A\\u0E38\\u0E21\\\", \\\"\\u0E01\\u0E32\\u0E23\\u0E40\\u0E07\\u0E34\\u0E19\\\", \\\"\\u0E44\\u0E2D\\u0E40\\u0E14\\u0E35\\u0E22\\u0E18\\u0E38\\u0E23\\u0E01\\u0E34\\u0E08\\\", \\\"\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E15\\u0E31\\u0E27\\\", \\\"\\u0E04\\u0E23\\u0E2D\\u0E1A\\u0E04\\u0E23\\u0E31\\u0E27\\\", \\\"\\u0E2A\\u0E38\\u0E02\\u0E20\\u0E32\\u0E1E\\\", \\\"\\u0E17\\u0E31\\u0E48\\u0E27\\u0E44\\u0E1B\\\"]\\n       - \\\"summary\\\": \\u0E2A\\u0E23\\u0E38\\u0E1B\\u0E40\\u0E19\\u0E37\\u0E49\\u0E2D\\u0E2B\\u0E32\\u0E42\\u0E14\\u0E22\\u0E43\\u0E0A\\u0E49 **Numbered List (1. 2. 3.)** \\u0E2A\\u0E33\\u0E2B\\u0E23\\u0E31\\u0E1A\\u0E02\\u0E31\\u0E49\\u0E19\\u0E15\\u0E2D\\u0E19 \\u0E41\\u0E25\\u0E30 **Bullet points (-)** \\u0E2A\\u0E33\\u0E2B\\u0E23\\u0E31\\u0E1A\\u0E23\\u0E32\\u0E22\\u0E01\\u0E32\\u0E23\\u0E17\\u0E31\\u0E48\\u0E27\\u0E44\\u0E1B\\n    Output Format: JSON object with key \\\"notes\\\" (array of objects).\\n  \";try{var _data$candidates,_data$candidates$,_data$candidates$$con,_data$candidates$$con2,_data$candidates$$con3;const response=await fetch(\"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=\".concat(GEMINI_API_KEY),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({contents:[{parts:[{text:systemPrompt},{text:\"Raw Input: \\\"\".concat(text,\"\\\"\")}]}],generationConfig:{responseMimeType:\"application/json\"}})});if(!response.ok)throw new Error(\"AI Request Failed\");const data=await response.json();let resultText=(_data$candidates=data.candidates)===null||_data$candidates===void 0?void 0:(_data$candidates$=_data$candidates[0])===null||_data$candidates$===void 0?void 0:(_data$candidates$$con=_data$candidates$.content)===null||_data$candidates$$con===void 0?void 0:(_data$candidates$$con2=_data$candidates$$con.parts)===null||_data$candidates$$con2===void 0?void 0:(_data$candidates$$con3=_data$candidates$$con2[0])===null||_data$candidates$$con3===void 0?void 0:_data$candidates$$con3.text;// Robust parsing\nconst firstBrace=resultText.indexOf(\"{\");const lastBrace=resultText.lastIndexOf(\"}\");if(firstBrace!==-1&&lastBrace!==-1){resultText=resultText.substring(firstBrace,lastBrace+1);}const parsedData=JSON.parse(resultText);const notesRaw=Array.isArray(parsedData.notes)?parsedData.notes:[parsedData];return notesRaw.map(n=>{let cleanSummary=\"\";if(typeof n.summary===\"string\"){cleanSummary=n.summary;}else if(Array.isArray(n.summary)){cleanSummary=n.summary.join(\"\\n\");}else{cleanSummary=JSON.stringify(n.summary||\"\");}return{title:typeof n.title===\"string\"?n.title:\"à¹„à¸¡à¹ˆà¸¡à¸µà¸Šà¸·à¹ˆà¸­à¹€à¸£à¸·à¹ˆà¸­à¸‡\",category:typeof n.category===\"string\"?n.category:\"à¸—à¸±à¹ˆà¸§à¹„à¸›\",summary:cleanSummary};});}catch(error){console.error(\"AI Error:\",error);return[{title:\"à¸šà¸±à¸™à¸—à¸¶à¸à¸‰à¸šà¸±à¸šà¸£à¹ˆà¸²à¸‡ (AI à¸‚à¸±à¸”à¸‚à¹‰à¸­à¸‡)\",summary:\"ðŸ“Œ à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹€à¸”à¸´à¸¡\\n- \"+text,category:\"à¸—à¸±à¹ˆà¸§à¹„à¸›\"}];}};const formatDateThai=timestamp=>{if(!timestamp)return\"\";try{const date=timestamp.toDate?timestamp.toDate():new Date(timestamp);if(isNaN(date.getTime()))return\"\";return date.toLocaleDateString(\"th-TH\",{day:\"numeric\",month:\"short\",year:\"2-digit\",hour:\"2-digit\",minute:\"2-digit\"});}catch(e){return\"\";}};const formatTimeThai=timestamp=>{if(!timestamp)return\"\";try{const date=timestamp.toDate?timestamp.toDate():new Date(timestamp);if(isNaN(date.getTime()))return\"\";return date.toLocaleTimeString(\"th-TH\",{hour:\"2-digit\",minute:\"2-digit\"});}catch(e){return\"\";}};const toDateTimeLocal=timestamp=>{if(!timestamp)return\"\";try{const date=timestamp.toDate?timestamp.toDate():new Date(timestamp);if(isNaN(date.getTime()))return\"\";const tzOffset=date.getTimezoneOffset()*60000;return new Date(date-tzOffset).toISOString().slice(0,16);}catch(e){return\"\";}};// --- Components ---\nconst AccessScreen=_ref=>{let{onJoin}=_ref;const[code,setCode]=useState(\"\");const handleSubmit=e=>{e.preventDefault();if(code.trim()){onJoin(code.trim());}};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-slate-50 flex flex-col items-center justify-center p-4 font-sans\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-3xl shadow-xl w-full max-w-md text-center border border-slate-100\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mx-auto mb-6\",children:/*#__PURE__*/_jsx(KeyRound,{size:32})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-slate-800 mb-2\",children:\"\\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E2B\\u0E49\\u0E2D\\u0E07\\u0E17\\u0E33\\u0E07\\u0E32\\u0E19\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-500 mb-6 text-sm\",children:[\"\\u0E01\\u0E23\\u0E2D\\u0E01\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E2B\\u0E49\\u0E2D\\u0E07\\u0E40\\u0E1E\\u0E37\\u0E48\\u0E2D\\u0E40\\u0E02\\u0E49\\u0E32\\u0E16\\u0E36\\u0E07\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\\u0E02\\u0E2D\\u0E07\\u0E04\\u0E38\\u0E13\",/*#__PURE__*/_jsx(\"br\",{}),\"(\\u0E40\\u0E0A\\u0E48\\u0E19 \\\"Zoom2026\\\")\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:code,onChange:e=>setCode(e.target.value),placeholder:\"\\u0E15\\u0E31\\u0E49\\u0E07\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E2B\\u0E49\\u0E2D\\u0E07 \\u0E2B\\u0E23\\u0E37\\u0E2D \\u0E43\\u0E2A\\u0E48\\u0E23\\u0E2B\\u0E31\\u0E2A...\",className:\"w-full px-4 py-3 text-center text-lg border-2 border-slate-200 rounded-xl focus:border-indigo-500 focus:outline-none transition-colors\",autoFocus:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!code.trim(),className:\"w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-indigo-200\",children:\"\\u0E40\\u0E02\\u0E49\\u0E32\\u0E43\\u0E0A\\u0E49\\u0E07\\u0E32\\u0E19\"})]})]})});};const ConfigScreen=()=>/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-slate-100 p-4 font-sans\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-xl shadow-lg max-w-lg text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mx-auto bg-red-100 w-16 h-16 rounded-full flex items-center justify-center mb-4 text-red-500\",children:/*#__PURE__*/_jsx(AlertCircle,{size:32})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-red-500 mb-4\",children:\"\\u0E22\\u0E31\\u0E07\\u0E44\\u0E21\\u0E48\\u0E44\\u0E14\\u0E49\\u0E15\\u0E31\\u0E49\\u0E07\\u0E04\\u0E48\\u0E32 Firebase\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-600 mb-4 leading-relaxed\",children:[\"\\u0E01\\u0E23\\u0E38\\u0E13\\u0E32\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\\u0E44\\u0E1F\\u0E25\\u0E4C \",/*#__PURE__*/_jsx(\"code\",{children:\"App.jsx\"}),\" \\u0E41\\u0E25\\u0E30\\u0E43\\u0E2A\\u0E48\\u0E04\\u0E48\\u0E32\",\" \",/*#__PURE__*/_jsx(\"code\",{children:\"firebaseConfig\"}),\" (\\u0E08\\u0E32\\u0E01 Firebase) \\u0E41\\u0E25\\u0E30\",\" \",/*#__PURE__*/_jsx(\"code\",{children:\"GEMINI_API_KEY\"}),\" (\\u0E08\\u0E32\\u0E01 AI Studio) \\u0E40\\u0E1E\\u0E37\\u0E48\\u0E2D\\u0E43\\u0E2B\\u0E49\\u0E41\\u0E2D\\u0E1E\\u0E17\\u0E33\\u0E07\\u0E32\\u0E19\\u0E44\\u0E14\\u0E49\\u0E04\\u0E23\\u0E31\\u0E1A\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-slate-400\",children:\"(\\u0E14\\u0E39\\u0E27\\u0E34\\u0E18\\u0E35\\u0E01\\u0E32\\u0E23\\u0E43\\u0E19\\u0E44\\u0E1F\\u0E25\\u0E4C\\u0E04\\u0E39\\u0E48\\u0E21\\u0E37\\u0E2D\\u0E01\\u0E32\\u0E23\\u0E15\\u0E34\\u0E14\\u0E15\\u0E31\\u0E49\\u0E07\\u0E17\\u0E35\\u0E48\\u0E1C\\u0E21\\u0E43\\u0E2B\\u0E49\\u0E44\\u0E1B\\u0E04\\u0E23\\u0E31\\u0E1A)\"})]})});const FormattedText=_ref2=>{let{text}=_ref2;if(!text)return null;let content=text;if(typeof text!==\"string\"){if(Array.isArray(text))content=text.join(\"\\n\");else if(typeof text===\"object\")content=JSON.stringify(text);else content=String(text);}return/*#__PURE__*/_jsx(\"div\",{className:\"space-y-1\",children:content.split(\"\\n\").map((line,index)=>{const trimmed=line.trim();if(!trimmed)return/*#__PURE__*/_jsx(\"div\",{className:\"h-2\"},index);const isHeader=trimmed.startsWith(\"ðŸ“Œ\")||trimmed.startsWith(\"ðŸ“\")||trimmed.match(/^à¸«à¸±à¸§à¸‚à¹‰à¸­/);const isNumberList=trimmed.match(/^\\d+\\./);const isBullet=trimmed.startsWith(\"-\")||trimmed.startsWith(\"â€¢\")||trimmed.startsWith(\"*\");return/*#__PURE__*/_jsx(\"div\",{className:\"\\n            \".concat(isHeader?\"font-bold text-indigo-900 mt-4 mb-2 text-base\":\"text-slate-600\",\" \\n            \").concat(isNumberList||isBullet?\"pl-4\":\"pl-0\",\"\\n            leading-relaxed\\n          \"),children:line},index);})});};const FullScreenEditor=_ref3=>{var _note$history;let{note,onClose,onSave,categoriesList}=_ref3;const[title,setTitle]=useState(\"\");const[content,setContent]=useState(\"\");const[category,setCategory]=useState(\"à¸—à¸±à¹ˆà¸§à¹„à¸›\");const[createdAt,setCreatedAt]=useState(\"\");const[isEditingCategory,setIsEditingCategory]=useState(false);const[tempCategoryName,setTempCategoryName]=useState(\"\");useEffect(()=>{if(note){setTitle(typeof note.title===\"string\"?note.title:\"\");let safeContent=\"\";if(typeof note.summary===\"string\")safeContent=note.summary;else if(Array.isArray(note.summary))safeContent=note.summary.join(\"\\n\");else safeContent=JSON.stringify(note.summary||\"\");setContent(safeContent);setCategory(typeof note.category===\"string\"?note.category:\"à¸—à¸±à¹ˆà¸§à¹„à¸›\");setCreatedAt(toDateTimeLocal(note.createdAt));}},[note]);const handleSave=()=>{let timestamp=note.createdAt;if(createdAt){try{timestamp=Timestamp.fromDate(new Date(createdAt));}catch(e){console.error(\"Invalid date\");}}onSave(note.id,{title,summary:content,category,createdAt:timestamp});onClose();};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 bg-white/95 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in zoom-in-95 duration-200 font-sans\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white w-full max-w-4xl h-[95vh] rounded-3xl shadow-2xl border border-slate-200 flex flex-col overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-4 border-b flex justify-between items-center bg-slate-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-indigo-100 p-2 rounded-lg text-indigo-600\",children:/*#__PURE__*/_jsx(Maximize2,{size:20})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-bold text-slate-800\",children:\"\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\\u0E41\\u0E1A\\u0E1A\\u0E40\\u0E15\\u0E47\\u0E21\\u0E08\\u0E2D\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-slate-500\",children:((_note$history=note.history)===null||_note$history===void 0?void 0:_note$history.length)>0?\"\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\\u0E41\\u0E25\\u0E49\\u0E27 \".concat(note.history.length,\" \\u0E04\\u0E23\\u0E31\\u0E49\\u0E07\"):\"à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸à¸²à¸£à¹à¸à¹‰à¹„à¸‚\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"p-2 hover:bg-slate-200 rounded-full text-slate-500\",children:/*#__PURE__*/_jsx(Minimize2,{size:24})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto p-8 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block\",children:\"\\u0E27\\u0E31\\u0E19\\u0E17\\u0E35\\u0E48\\u0E41\\u0E25\\u0E30\\u0E40\\u0E27\\u0E25\\u0E32\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 bg-slate-50 p-2 rounded-xl border border-slate-200 focus-within:ring-2 focus-within:ring-indigo-100\",children:[/*#__PURE__*/_jsx(Calendar,{size:18,className:\"text-slate-400 ml-2\"}),/*#__PURE__*/_jsx(\"input\",{type:\"datetime-local\",value:createdAt,onChange:e=>setCreatedAt(e.target.value),className:\"bg-transparent border-none focus:outline-none text-slate-700 w-full font-medium\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block\",children:\"\\u0E2B\\u0E21\\u0E27\\u0E14\\u0E2B\\u0E21\\u0E39\\u0E48 (\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E44\\u0E14\\u0E49)\"}),isEditingCategory?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 h-[42px]\",children:[/*#__PURE__*/_jsx(\"input\",{value:tempCategoryName,onChange:e=>setTempCategoryName(e.target.value),className:\"flex-1 border border-indigo-300 rounded-lg px-3 py-2 text-sm focus:outline-indigo-500\",placeholder:\"\\u0E1E\\u0E34\\u0E21\\u0E1E\\u0E4C\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E2B\\u0E21\\u0E27\\u0E14\\u0E2B\\u0E21\\u0E39\\u0E48...\",autoFocus:true,onKeyDown:e=>{if(e.key===\"Enter\"){if(tempCategoryName.trim())setCategory(tempCategoryName.trim());setIsEditingCategory(false);}}}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(tempCategoryName.trim())setCategory(tempCategoryName.trim());setIsEditingCategory(false);},className:\"p-2 bg-green-500 text-white rounded-lg hover:bg-green-600\",children:/*#__PURE__*/_jsx(Check,{size:16})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsEditingCategory(false),className:\"p-2 bg-slate-200 text-slate-500 rounded-lg hover:bg-slate-300\",children:/*#__PURE__*/_jsx(X,{size:16})})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col gap-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between gap-3 bg-indigo-50 border border-indigo-200 text-indigo-700 px-3 py-2 rounded-lg font-medium text-sm w-full md:w-auto min-w-[150px]\",children:[/*#__PURE__*/_jsx(\"span\",{children:category}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setTempCategoryName(category);setIsEditingCategory(true);},className:\"hover:bg-indigo-200 rounded p-1 text-indigo-400 hover:text-indigo-700 transition-colors\",title:\"\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E2B\\u0E21\\u0E27\\u0E14\\u0E2B\\u0E21\\u0E39\\u0E48\",children:/*#__PURE__*/_jsx(Pencil,{size:14})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 flex-wrap mt-1\",children:[categoriesList.filter(c=>c!==category).slice(0,5).map(cat=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCategory(cat),className:\"px-2 py-1 rounded text-xs bg-slate-100 text-slate-500 hover:bg-slate-200 transition-colors border border-transparent\",children:cat},cat)),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setTempCategoryName(\"\");setIsEditingCategory(true);},className:\"px-2 py-1 rounded text-xs border border-dashed border-slate-300 text-slate-400 hover:text-indigo-600 hover:border-indigo-400 flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Plus,{size:10}),\" \\u0E40\\u0E1E\\u0E34\\u0E48\\u0E21\\u0E43\\u0E2B\\u0E21\\u0E48\"]})]})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"border-slate-100\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block\",children:\"\\u0E2B\\u0E31\\u0E27\\u0E02\\u0E49\\u0E2D\\u0E40\\u0E23\\u0E37\\u0E48\\u0E2D\\u0E07\"}),/*#__PURE__*/_jsx(\"input\",{value:title,onChange:e=>setTitle(e.target.value),className:\"w-full text-3xl font-bold text-slate-900 border-b-2 border-slate-100 focus:border-indigo-500 focus:outline-none pb-2 placeholder-slate-300 transition-colors\",placeholder:\"\\u0E43\\u0E2A\\u0E48\\u0E0A\\u0E37\\u0E48\\u0E2D\\u0E40\\u0E23\\u0E37\\u0E48\\u0E2D\\u0E07...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"h-full\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block\",children:\"\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14 (1. 2. 3. \\u0E2B\\u0E23\\u0E37\\u0E2D -)\"}),/*#__PURE__*/_jsx(\"textarea\",{value:content,onChange:e=>setContent(e.target.value),className:\"w-full h-[400px] text-lg text-slate-700 leading-relaxed resize-none focus:outline-none p-4 -ml-4 rounded-xl border border-transparent focus:border-slate-100 focus:bg-slate-50 transition-all font-sans\",placeholder:\"\\u0E23\\u0E32\\u0E22\\u0E25\\u0E30\\u0E40\\u0E2D\\u0E35\\u0E22\\u0E14...\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-4 border-t bg-slate-50 flex justify-end gap-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"px-6 py-2.5 rounded-xl text-slate-500 hover:bg-slate-200 font-medium transition-colors\",children:\"\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleSave,className:\"px-6 py-2.5 rounded-xl bg-indigo-600 text-white shadow-lg shadow-indigo-200 hover:bg-indigo-700 font-medium transition-all flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Save,{size:18}),\" \\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\\u0E41\\u0E25\\u0E30\\u0E2A\\u0E33\\u0E23\\u0E2D\\u0E07\\u0E1B\\u0E23\\u0E30\\u0E27\\u0E31\\u0E15\\u0E34\"]})]})]})});};const NoteCard=_ref4=>{let{note,onEdit,onDelete,onExpand}=_ref4;const[isEditing,setIsEditing]=useState(false);const[editedTitle,setEditedTitle]=useState(\"\");const[editedContent,setEditedContent]=useState(\"\");useEffect(()=>{setEditedTitle(typeof note.title===\"string\"?note.title:\"\");let safeContent=\"\";if(typeof note.summary===\"string\")safeContent=note.summary;else if(Array.isArray(note.summary))safeContent=note.summary.join(\"\\n\");else safeContent=JSON.stringify(note.summary||\"\");setEditedContent(safeContent);},[note]);const handleQuickSave=()=>{onEdit(note.id,{title:editedTitle,summary:editedContent});setIsEditing(false);};const categoryColors={à¸›à¸£à¸°à¸Šà¸¸à¸¡:\"bg-blue-50 border-blue-200 text-blue-700\",à¸à¸²à¸£à¹€à¸‡à¸´à¸™:\"bg-green-50 border-green-200 text-green-700\",à¹„à¸­à¹€à¸”à¸µà¸¢à¸˜à¸¸à¸£à¸à¸´à¸ˆ:\"bg-amber-50 border-amber-200 text-amber-700\",à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§:\"bg-pink-50 border-pink-200 text-pink-700\",à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§:\"bg-purple-50 border-purple-200 text-purple-700\",à¸ªà¸¸à¸‚à¸ à¸²à¸ž:\"bg-teal-50 border-teal-200 text-teal-700\",à¸—à¸±à¹ˆà¸§à¹„à¸›:\"bg-gray-50 border-gray-200 text-gray-700\"};const themeClass=categoryColors[note.category]||\"bg-indigo-50 border-indigo-200 text-indigo-700\";return/*#__PURE__*/_jsxs(\"div\",{className:\"group relative flex flex-col p-5 rounded-2xl border bg-white transition-all duration-300 hover:-translate-y-1 hover:shadow-lg \".concat(isEditing?\"z-10 ring-2 ring-indigo-500\":\"\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-[10px] uppercase tracking-wide font-bold px-2.5 py-1 rounded-md border \".concat(themeClass),children:typeof note.category===\"string\"?note.category:\"à¸—à¸±à¹ˆà¸§à¹„à¸›\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onExpand(note);},className:\"p-1.5 hover:bg-indigo-50 hover:text-indigo-600 rounded-full text-gray-400 transition-colors\",title:\"\\u0E14\\u0E39\\u0E40\\u0E15\\u0E47\\u0E21\\u0E08\\u0E2D\",children:/*#__PURE__*/_jsx(Maximize2,{size:16})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();setIsEditing(!isEditing);},className:\"p-1.5 hover:bg-gray-100 rounded-full text-gray-400 transition-colors\",title:\"\\u0E41\\u0E01\\u0E49\\u0E44\\u0E02\\u0E14\\u0E48\\u0E27\\u0E19\",children:/*#__PURE__*/_jsx(Pencil,{size:16})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onDelete(note.id);},className:\"p-1.5 hover:bg-red-50 hover:text-red-500 rounded-full text-gray-400 transition-colors\",title:\"\\u0E25\\u0E1A\",children:/*#__PURE__*/_jsx(Trash2,{size:16})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3 flex-1\",children:isEditing?/*#__PURE__*/_jsxs(\"div\",{onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"input\",{value:editedTitle,onChange:e=>setEditedTitle(e.target.value),className:\"w-full font-bold text-gray-900 text-lg border-b pb-1 focus:outline-none focus:border-indigo-500\"}),/*#__PURE__*/_jsx(\"textarea\",{value:editedContent,onChange:e=>setEditedContent(e.target.value),className:\"w-full text-sm text-gray-700 resize-none focus:outline-none bg-gray-50 p-2 rounded-lg border border-transparent focus:border-indigo-200 font-sans\",rows:6}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-2 mt-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsEditing(false),className:\"px-3 py-1 text-xs text-gray-500\",children:\"\\u0E22\\u0E01\\u0E40\\u0E25\\u0E34\\u0E01\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleQuickSave,className:\"px-3 py-1 text-xs bg-indigo-600 text-white rounded-md\",children:\"\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\"})]})]}):/*#__PURE__*/_jsxs(\"div\",{onClick:()=>onExpand(note),className:\"cursor-pointer\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-gray-900 text-lg mb-2 leading-tight hover:text-indigo-700 transition-colors\",children:typeof note.title===\"string\"?note.title:\"à¹„à¸¡à¹ˆà¸¡à¸µà¸«à¸±à¸§à¸‚à¹‰à¸­\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm line-clamp-6\",children:/*#__PURE__*/_jsx(FormattedText,{text:note.summary})})]})}),!isEditing&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-5 pt-3 border-t border-gray-100 flex items-center justify-between text-xs text-gray-400 font-medium\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Calendar,{size:12}),formatDateThai(note.createdAt)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[/*#__PURE__*/_jsx(Clock,{size:12}),formatTimeThai(note.createdAt)]})]})]});};export default function SmartNoteApp(){// --- All hooks must be called first, before any conditional returns ---\nconst[user,setUser]=useState(null);const[accessCode,setAccessCode]=useState(()=>localStorage.getItem(\"zoom_note_access_code\")||\"\");const[inputMode,setInputMode]=useState(false);const[rawText,setRawText]=useState(\"\");const[notes,setNotes]=useState([]);const[loading,setLoading]=useState(true);const[isProcessing,setIsProcessing]=useState(false);const[searchQuery,setSearchQuery]=useState(\"\");const[selectedCategory,setSelectedCategory]=useState(\"à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”\");const[selectedDate,setSelectedDate]=useState(\"\");const[expandedNote,setExpandedNote]=useState(null);const baseCategories=[\"à¸›à¸£à¸°à¸Šà¸¸à¸¡\",\"à¸à¸²à¸£à¹€à¸‡à¸´à¸™\",\"à¹„à¸­à¹€à¸”à¸µà¸¢à¸˜à¸¸à¸£à¸à¸´à¸ˆ\",\"à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§\",\"à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§\",\"à¸ªà¸¸à¸‚à¸ à¸²à¸ž\",\"à¸—à¸±à¹ˆà¸§à¹„à¸›\"];const categoriesList=useMemo(()=>{const noteCategories=notes.map(n=>n.category).filter(c=>typeof c===\"string\");return[...new Set([...baseCategories,...noteCategories])];},[notes]);// --- Auto-inject Tailwind for CodeSandbox ---\nuseEffect(()=>{if(!document.getElementById(\"tailwind-script\")){const script=document.createElement(\"script\");script.src=\"https://cdn.tailwindcss.com\";script.id=\"tailwind-script\";document.head.appendChild(script);}},[]);useEffect(()=>{if(!isConfigured)return;const initAuth=async()=>{await signInAnonymously(auth);};initAuth();const unsubscribe=onAuthStateChanged(auth,setUser);return()=>unsubscribe();},[]);// Sync Access Code to Public Collection\nuseEffect(()=>{if(!isConfigured||!user||!accessCode){if(!accessCode)setLoading(false);return;}setLoading(true);// Use PUBLIC path with accessCode as a key\nconst collectionPath=\"smart_notes_shared_\".concat(accessCode.replace(/[^a-zA-Z0-9]/g,\"_\"));const q=query(collection(db,\"artifacts\",appId,\"public\",\"data\",collectionPath),orderBy(\"createdAt\",\"desc\"));const unsubscribe=onSnapshot(q,snapshot=>{const notesData=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setNotes(notesData);setLoading(false);},error=>{console.error(error);setLoading(false);});return()=>unsubscribe();},[user,accessCode]);const handleJoinSpace=code=>{setAccessCode(code);localStorage.setItem(\"zoom_note_access_code\",code);};const handleLogoutSpace=()=>{setAccessCode(\"\");localStorage.removeItem(\"zoom_note_access_code\");setNotes([]);};const getCollectionPath=()=>{return\"smart_notes_shared_\".concat(accessCode.replace(/[^a-zA-Z0-9]/g,\"_\"));};const handleProcessNote=async()=>{if(!rawText.trim())return;setIsProcessing(true);const notesArray=await callGeminiAI(rawText);try{const colPath=getCollectionPath();const promises=notesArray.map(noteData=>addDoc(collection(db,\"artifacts\",appId,\"public\",\"data\",colPath),_objectSpread(_objectSpread({},noteData),{},{rawContent:rawText,createdAt:serverTimestamp(),isProcessed:true,history:[],createdBy:user.uid})));await Promise.all(promises);setRawText(\"\");setInputMode(false);}catch(error){console.error(error);alert(\"à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”à¹ƒà¸™à¸à¸²à¸£à¸šà¸±à¸™à¸—à¸¶à¸\");}finally{setIsProcessing(false);}};const handleUpdateNote=async(id,newData)=>{try{const oldNote=notes.find(n=>n.id===id);if(!oldNote)return;const historySnapshot={title:oldNote.title,summary:oldNote.summary,category:oldNote.category,editedAt:new Date().toISOString()};const colPath=getCollectionPath();await updateDoc(doc(db,\"artifacts\",appId,\"public\",\"data\",colPath,id),_objectSpread(_objectSpread({},newData),{},{history:arrayUnion(historySnapshot)}));}catch(error){console.error(error);}};const handleDeleteNote=async id=>{if(window.confirm(\"à¸„à¸¸à¸“à¹à¸™à¹ˆà¹ƒà¸ˆà¸§à¹ˆà¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸¥à¸šà¸šà¸±à¸™à¸—à¸¶à¸à¸™à¸µà¹‰? (à¸¥à¸šà¹à¸¥à¹‰à¸§à¸à¸¹à¹‰à¸„à¸·à¸™à¹„à¸¡à¹ˆà¹„à¸”à¹‰)\")){try{const colPath=getCollectionPath();await deleteDoc(doc(db,\"artifacts\",appId,\"public\",\"data\",colPath,id));}catch(error){console.error(error);}}};const filteredNotes=useMemo(()=>{return notes.filter(note=>{const safeTitle=typeof note.title===\"string\"?note.title:\"\";const safeSummary=typeof note.summary===\"string\"?note.summary:\"\";const matchesSearch=(safeTitle+safeSummary).toLowerCase().includes(searchQuery.toLowerCase());const matchesCategory=selectedCategory===\"à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”\"||note.category===selectedCategory;let matchesDate=true;if(selectedDate&&note.createdAt){try{const noteDate=note.createdAt.toDate?note.createdAt.toDate():new Date(note.createdAt);const noteDateString=noteDate.toISOString().split(\"T\")[0];matchesDate=noteDateString===selectedDate;}catch(e){matchesDate=false;}}return matchesSearch&&matchesCategory&&matchesDate;});},[notes,searchQuery,selectedCategory,selectedDate]);// --- Now conditional returns are safe ---\nif(!isConfigured)return/*#__PURE__*/_jsx(ConfigScreen,{});if(!accessCode){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(AccessScreen,{onJoin:handleJoinSpace})});}if(loading)return/*#__PURE__*/_jsxs(\"div\",{className:\"h-screen flex items-center justify-center text-indigo-600 bg-white font-sans\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"animate-spin mr-2\"}),\" \\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E40\\u0E02\\u0E49\\u0E32\\u0E2A\\u0E39\\u0E48\\u0E2B\\u0E49\\u0E2D\\u0E07 \",accessCode,\"...\"]});return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-slate-50 text-slate-800 font-sans\",children:[expandedNote&&/*#__PURE__*/_jsx(FullScreenEditor,{note:expandedNote,onClose:()=>setExpandedNote(null),onSave:handleUpdateNote,categoriesList:categoriesList}),/*#__PURE__*/_jsxs(\"header\",{className:\"sticky top-0 z-30 bg-white/90 backdrop-blur-xl border-b border-slate-200 px-6 py-4 flex items-center justify-between shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-indigo-600 text-white p-2 rounded-xl shadow-lg shadow-indigo-200\",children:/*#__PURE__*/_jsx(Bot,{size:24})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"font-bold text-xl text-slate-900 tracking-tight flex items-center gap-2\",children:[accessCode,/*#__PURE__*/_jsx(\"span\",{className:\"text-xs bg-indigo-100 text-indigo-600 px-2 py-0.5 rounded-full font-normal\",children:\"Shared Space\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-medium text-slate-500\",children:\"\\u0E40\\u0E25\\u0E02\\u0E32\\u0E2A\\u0E48\\u0E27\\u0E19\\u0E15\\u0E31\\u0E27\\u0E02\\u0E2D\\u0E07\\u0E04\\u0E38\\u0E13\\u0E0B\\u0E39\\u0E21\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[!inputMode&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setInputMode(true),className:\"bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-full shadow-lg shadow-indigo-300/50 flex items-center gap-2 transition-all active:scale-95 transform hover:-translate-y-0.5\",children:[/*#__PURE__*/_jsx(Plus,{size:20}),\" \",/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline font-medium\",children:\"\\u0E08\\u0E14\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogoutSpace,className:\"bg-slate-100 hover:bg-slate-200 text-slate-600 p-2.5 rounded-full transition-colors\",title:\"\\u0E2D\\u0E2D\\u0E01\\u0E08\\u0E32\\u0E01\\u0E2B\\u0E49\\u0E2D\\u0E07\",children:/*#__PURE__*/_jsx(LogOut,{size:20})})]})]}),/*#__PURE__*/_jsx(\"main\",{className:\"max-w-7xl mx-auto p-4 md:p-8\",children:inputMode?/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-3xl mx-auto animate-in fade-in slide-in-from-bottom-8 duration-500\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4 mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center flex-shrink-0\",children:/*#__PURE__*/_jsx(Bot,{size:20,className:\"text-indigo-600\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-4 rounded-2xl rounded-tl-none shadow-sm border border-slate-100 text-slate-700\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0E1E\\u0E23\\u0E49\\u0E2D\\u0E21\\u0E04\\u0E23\\u0E31\\u0E1A! \\u0E1E\\u0E34\\u0E21\\u0E1E\\u0E4C\\u0E02\\u0E49\\u0E2D\\u0E04\\u0E27\\u0E32\\u0E21\\u0E14\\u0E34\\u0E1A\\u0E21\\u0E32\\u0E44\\u0E14\\u0E49\\u0E40\\u0E25\\u0E22 \\u0E40\\u0E14\\u0E35\\u0E4B\\u0E22\\u0E27\\u0E1C\\u0E21\\u0E41\\u0E22\\u0E01\\u0E2B\\u0E31\\u0E27\\u0E02\\u0E49\\u0E2D\\u0E43\\u0E2B\\u0E49\\u0E2D\\u0E31\\u0E15\\u0E42\\u0E19\\u0E21\\u0E31\\u0E15\\u0E34 (\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\\u0E19\\u0E35\\u0E49\\u0E08\\u0E30\\u0E40\\u0E2B\\u0E47\\u0E19\\u0E17\\u0E38\\u0E01\\u0E04\\u0E19\\u0E43\\u0E19\\u0E2B\\u0E49\\u0E2D\\u0E07\",\" \",/*#__PURE__*/_jsx(\"b\",{children:accessCode}),\" \\u0E04\\u0E23\\u0E31\\u0E1A)\"]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-3xl shadow-xl shadow-slate-200/50 overflow-hidden border border-slate-100 relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-4 right-4 z-10\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>!isProcessing&&setInputMode(false),className:\"p-2 hover:bg-slate-100 rounded-full text-slate-400 hover:text-slate-600 transition-colors\",children:/*#__PURE__*/_jsx(X,{size:20})})}),/*#__PURE__*/_jsx(\"textarea\",{value:rawText,onChange:e=>setRawText(e.target.value),disabled:isProcessing,placeholder:\"\\u0E1E\\u0E34\\u0E21\\u0E1E\\u0E4C\\u0E17\\u0E35\\u0E48\\u0E19\\u0E35\\u0E48...\",className:\"w-full h-[320px] p-6 text-lg text-slate-700 placeholder:text-slate-300 resize-none focus:outline-none leading-relaxed\",autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-slate-50 border-t border-slate-100 flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-slate-400 pl-2\",children:rawText.length>0?\"\".concat(rawText.length,\" \\u0E15\\u0E31\\u0E27\\u0E2D\\u0E31\\u0E01\\u0E29\\u0E23\"):\"à¸£à¸­à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥...\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleProcessNote,disabled:!rawText.trim()||isProcessing,className:\"bg-indigo-600 hover:bg-indigo-700 disabled:bg-slate-300 disabled:cursor-not-allowed text-white px-6 py-3 rounded-xl font-medium shadow-lg hover:shadow-xl transition-all flex items-center gap-2 active:scale-95\",children:isProcessing?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Loader2,{size:18,className:\"animate-spin\"}),\" \",\"\\u0E01\\u0E33\\u0E25\\u0E31\\u0E07\\u0E1B\\u0E23\\u0E30\\u0E21\\u0E27\\u0E25\\u0E1C\\u0E25...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Sparkles,{size:18}),\" \\u0E2A\\u0E23\\u0E38\\u0E1B\\u0E41\\u0E25\\u0E30\\u0E41\\u0E22\\u0E01\\u0E2B\\u0E31\\u0E27\\u0E02\\u0E49\\u0E2D\\u0E17\\u0E31\\u0E19\\u0E17\\u0E35\"]})})]})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col xl:flex-row gap-4 justify-between bg-white p-4 rounded-2xl shadow-sm border border-slate-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row gap-3 w-full xl:w-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 bg-slate-50 rounded-xl px-4 py-2.5 border border-slate-200 focus-within:ring-2 focus-within:ring-indigo-100 transition-all flex-1 sm:flex-none sm:w-64\",children:[/*#__PURE__*/_jsx(Search,{size:18,className:\"text-slate-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0E04\\u0E49\\u0E19\\u0E2B\\u0E32...\",value:searchQuery,onChange:e=>setSearchQuery(e.target.value),className:\"bg-transparent border-none focus:outline-none text-sm w-full text-slate-700\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 bg-slate-50 rounded-xl px-4 py-2.5 border border-slate-200 text-slate-600 hover:bg-white transition-colors cursor-pointer w-full sm:w-auto\",children:[/*#__PURE__*/_jsx(Calendar,{size:18,className:\"text-slate-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:selectedDate,onChange:e=>setSelectedDate(e.target.value),className:\"bg-transparent border-none focus:outline-none text-sm text-slate-700 cursor-pointer w-full\"}),selectedDate&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedDate(\"\"),className:\"ml-2 p-1 hover:bg-slate-200 rounded-full\",children:/*#__PURE__*/_jsx(X,{size:14})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 overflow-x-auto pb-2 xl:pb-0 scrollbar-hide\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedCategory(\"à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”\"),className:\"px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-all border \".concat(selectedCategory===\"à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”\"?\"bg-indigo-600 text-white border-indigo-600 shadow-md\":\"bg-white text-slate-600 border-slate-200 hover:bg-slate-50\"),children:\"\\u0E17\\u0E31\\u0E49\\u0E07\\u0E2B\\u0E21\\u0E14\"}),categoriesList.map(cat=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedCategory(cat),className:\"px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-all border \".concat(selectedCategory===cat?\"bg-indigo-600 text-white border-indigo-600 shadow-md\":\"bg-white text-slate-600 border-slate-200 hover:bg-slate-50\"),children:cat},cat))]})]}),filteredNotes.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-24 opacity-60\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-slate-100 w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6\",children:/*#__PURE__*/_jsx(Users,{className:\"text-slate-400\",size:40})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-slate-600 font-medium text-lg\",children:\"\\u0E2B\\u0E49\\u0E2D\\u0E07\\u0E19\\u0E35\\u0E49\\u0E22\\u0E31\\u0E07\\u0E27\\u0E48\\u0E32\\u0E07\\u0E2D\\u0E22\\u0E39\\u0E48\\u0E04\\u0E23\\u0E31\\u0E1A\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-400 text-sm mt-2\",children:[\"\\u0E40\\u0E23\\u0E34\\u0E48\\u0E21\\u0E08\\u0E14\\u0E1A\\u0E31\\u0E19\\u0E17\\u0E36\\u0E01\\u0E44\\u0E14\\u0E49\\u0E40\\u0E25\\u0E22 \\u0E02\\u0E49\\u0E2D\\u0E21\\u0E39\\u0E25\\u0E08\\u0E30\\u0E16\\u0E39\\u0E01\\u0E41\\u0E0A\\u0E23\\u0E4C\\u0E43\\u0E2B\\u0E49\\u0E17\\u0E38\\u0E01\\u0E04\\u0E19\\u0E17\\u0E35\\u0E48\\u0E21\\u0E35\\u0E23\\u0E2B\\u0E31\\u0E2A \\\"\",/*#__PURE__*/_jsx(\"b\",{children:accessCode}),\"\\\" \\u0E04\\u0E23\\u0E31\\u0E1A\"]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 auto-rows-max\",children:filteredNotes.map(note=>/*#__PURE__*/_jsx(NoteCard,{note:note,onEdit:handleUpdateNote,onDelete:handleDeleteNote,onExpand:setExpandedNote},note.id))})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","useMemo","initializeApp","getFirestore","collection","addDoc","updateDoc","deleteDoc","doc","onSnapshot","query","orderBy","serverTimestamp","Timestamp","arrayUnion","getAuth","signInAnonymously","onAuthStateChanged","Pencil","Save","Trash2","Search","Calendar","Sparkles","Plus","X","Loader2","Bot","Maximize2","Minimize2","Clock","Check","Users","LogOut","KeyRound","AlertCircle","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","GEMINI_API_KEY","isConfigured","includes","app","auth","db","e","console","error","callGeminiAI","text","alert","title","category","summary","systemPrompt","_data$candidates","_data$candidates$","_data$candidates$$con","_data$candidates$$con2","_data$candidates$$con3","response","fetch","concat","method","headers","body","JSON","stringify","contents","parts","generationConfig","responseMimeType","ok","Error","data","json","resultText","candidates","content","firstBrace","indexOf","lastBrace","lastIndexOf","substring","parsedData","parse","notesRaw","Array","isArray","notes","map","n","cleanSummary","join","formatDateThai","timestamp","date","toDate","Date","isNaN","getTime","toLocaleDateString","day","month","year","hour","minute","formatTimeThai","toLocaleTimeString","toDateTimeLocal","tzOffset","getTimezoneOffset","toISOString","slice","AccessScreen","_ref","onJoin","code","setCode","handleSubmit","preventDefault","trim","className","children","size","onSubmit","type","value","onChange","target","placeholder","autoFocus","disabled","ConfigScreen","FormattedText","_ref2","String","split","line","index","trimmed","isHeader","startsWith","match","isNumberList","isBullet","FullScreenEditor","_ref3","_note$history","note","onClose","onSave","categoriesList","setTitle","setContent","setCategory","createdAt","setCreatedAt","isEditingCategory","setIsEditingCategory","tempCategoryName","setTempCategoryName","safeContent","handleSave","fromDate","id","history","length","onClick","onKeyDown","key","filter","c","cat","NoteCard","_ref4","onEdit","onDelete","onExpand","isEditing","setIsEditing","editedTitle","setEditedTitle","editedContent","setEditedContent","handleQuickSave","categoryColors","à¸›à¸£à¸°à¸Šà¸¸à¸¡","à¸à¸²à¸£à¹€à¸‡à¸´à¸™","à¹„à¸­à¹€à¸”à¸µà¸¢à¸˜à¸¸à¸£à¸à¸´à¸ˆ","à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§","à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§","à¸ªà¸¸à¸‚à¸ à¸²à¸ž","à¸—à¸±à¹ˆà¸§à¹„à¸›","themeClass","stopPropagation","rows","SmartNoteApp","user","setUser","accessCode","setAccessCode","localStorage","getItem","inputMode","setInputMode","rawText","setRawText","setNotes","loading","setLoading","isProcessing","setIsProcessing","searchQuery","setSearchQuery","selectedCategory","setSelectedCategory","selectedDate","setSelectedDate","expandedNote","setExpandedNote","baseCategories","noteCategories","Set","document","getElementById","script","createElement","src","head","appendChild","initAuth","unsubscribe","collectionPath","replace","q","snapshot","notesData","docs","_objectSpread","handleJoinSpace","setItem","handleLogoutSpace","removeItem","getCollectionPath","handleProcessNote","notesArray","colPath","promises","noteData","rawContent","isProcessed","createdBy","uid","Promise","all","handleUpdateNote","newData","oldNote","find","historySnapshot","editedAt","handleDeleteNote","window","confirm","filteredNotes","safeTitle","safeSummary","matchesSearch","toLowerCase","matchesCategory","matchesDate","noteDate","noteDateString"],"sources":["C:/Users/lipto/Desktop/react/smart-note-app/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from \"react\";\nimport { initializeApp } from \"firebase/app\";\nimport {\n  getFirestore,\n  collection,\n  addDoc,\n  updateDoc,\n  deleteDoc,\n  doc,\n  onSnapshot,\n  query,\n  orderBy,\n  serverTimestamp,\n  Timestamp,\n  arrayUnion,\n} from \"firebase/firestore\";\nimport { getAuth, signInAnonymously, onAuthStateChanged } from \"firebase/auth\";\nimport {\n  Pencil,\n  Save,\n  Trash2,\n  Search,\n  Calendar,\n  Sparkles,\n  Plus,\n  X,\n  Loader2,\n  Bot,\n  Maximize2,\n  Minimize2,\n  Clock,\n  Check,\n  Users,\n  LogOut,\n  KeyRound,\n  AlertCircle,\n} from \"lucide-react\";\n\n// --- à¸ªà¹ˆà¸§à¸™à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² (à¸•à¹‰à¸­à¸‡à¹à¸à¹‰à¹„à¸‚à¸•à¸£à¸‡à¸™à¸µà¹‰à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸ˆà¸£à¸´à¸‡) ---\n// 1. à¹„à¸›à¸—à¸µà¹ˆ console.firebase.google.com à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸›à¸£à¹€à¸ˆà¸à¸•à¹Œà¹ƒà¸«à¸¡à¹ˆ\n// 2. à¸ªà¸£à¹‰à¸²à¸‡ Web App à¹à¸¥à¸°à¸à¹Šà¸­à¸›à¸›à¸µà¹‰à¸„à¹ˆà¸² config à¸¡à¸²à¹ƒà¸ªà¹ˆà¹à¸—à¸™à¸—à¸µà¹ˆà¸•à¸£à¸‡à¸™à¸µà¹‰à¸„à¸£à¸±à¸š\nconst firebaseConfig = {\n  apiKey: \"AIzaSyBC2seZeDwSnzQv74OxfUap3IilWZi2oUA\", // à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\n  authDomain: \"zoom-smart-note.firebaseapp.com\", // à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\n  projectId: \"zoom-smart-note\", // à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\n  storageBucket: \"zoom-smart-note.firebasestorage.app\", // à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\n  messagingSenderId: \"391568270505\", // à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\n  appId: \"1:391568270505:web:f523347b05de36288df5b8\", // à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ\n};\n\n// --- API Key à¸‚à¸­à¸‡ Gemini AI (à¹ƒà¸ªà¹ˆà¸•à¸£à¸‡à¸™à¸µà¹‰) ---\n// à¹„à¸›à¸‚à¸­à¸Ÿà¸£à¸µà¹„à¸”à¹‰à¸—à¸µà¹ˆ aistudio.google.com\nconst GEMINI_API_KEY = \"AIzaSyCH7dU_lGn71g2m0zQuk4flmcyp8QfPqk0\";\n\n// --- à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸£à¸°à¸šà¸š ---\nconst isConfigured =\n  firebaseConfig.apiKey && !firebaseConfig.apiKey.includes(\"AIzaSy...\");\n\nlet app, auth, db;\nif (isConfigured) {\n  try {\n    app = initializeApp(firebaseConfig);\n    auth = getAuth(app);\n    db = getFirestore(app);\n  } catch (e) {\n    console.error(\"Firebase Init Error:\", e);\n  }\n}\n\nconst appId = \"smart-note-production\";\n\n// --- AI Service ---\nconst callGeminiAI = async (text) => {\n  if (!GEMINI_API_KEY) {\n    alert(\"à¸à¸£à¸¸à¸“à¸²à¹ƒà¸ªà¹ˆ GEMINI_API_KEY à¹ƒà¸™à¹‚à¸„à¹‰à¸”à¸à¹ˆà¸­à¸™à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ AI à¸„à¸£à¸±à¸š\");\n    return [\n      {\n        title: \"AI Setup Needed\",\n        category: \"à¸—à¸±à¹ˆà¸§à¹„à¸›\",\n        summary: \"Please configure API Key\",\n      },\n    ];\n  }\n\n  const systemPrompt = `\n    Role: à¸„à¸¸à¸“à¸„à¸·à¸­à¹€à¸¥à¸‚à¸²à¸­à¸±à¸ˆà¸‰à¸£à¸´à¸¢à¸°à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§\n    Task: à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸”à¸´à¸šà¹à¸¥à¹‰à¸§ \"à¹à¸¢à¸à¸«à¸±à¸§à¸‚à¹‰à¸­\" (Split Topics)\n    Instructions:\n    1. à¹à¸¢à¸à¸›à¸£à¸°à¹€à¸”à¹‡à¸™à¹ƒà¸™à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸­à¸­à¸à¹€à¸›à¹‡à¸™à¹‚à¸™à¹‰à¸•à¸¢à¹ˆà¸­à¸¢à¹†\n    2. à¹à¸•à¹ˆà¸¥à¸°à¹‚à¸™à¹‰à¸•à¸•à¹‰à¸­à¸‡à¸¡à¸µ format:\n       - \"title\": à¸Šà¸·à¹ˆà¸­à¹€à¸£à¸·à¹ˆà¸­à¸‡ (à¹„à¸¡à¹ˆà¹€à¸à¸´à¸™ 10 à¸„à¸³)\n       - \"category\": à¹€à¸¥à¸·à¸­à¸à¸ˆà¸²à¸ [\"à¸›à¸£à¸°à¸Šà¸¸à¸¡\", \"à¸à¸²à¸£à¹€à¸‡à¸´à¸™\", \"à¹„à¸­à¹€à¸”à¸µà¸¢à¸˜à¸¸à¸£à¸à¸´à¸ˆ\", \"à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§\", \"à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§\", \"à¸ªà¸¸à¸‚à¸ à¸²à¸ž\", \"à¸—à¸±à¹ˆà¸§à¹„à¸›\"]\n       - \"summary\": à¸ªà¸£à¸¸à¸›à¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¹‚à¸”à¸¢à¹ƒà¸Šà¹‰ **Numbered List (1. 2. 3.)** à¸ªà¸³à¸«à¸£à¸±à¸šà¸‚à¸±à¹‰à¸™à¸•à¸­à¸™ à¹à¸¥à¸° **Bullet points (-)** à¸ªà¸³à¸«à¸£à¸±à¸šà¸£à¸²à¸¢à¸à¸²à¸£à¸—à¸±à¹ˆà¸§à¹„à¸›\n    Output Format: JSON object with key \"notes\" (array of objects).\n  `;\n\n  try {\n    const response = await fetch(\n      `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${GEMINI_API_KEY}`,\n      {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          contents: [\n            {\n              parts: [{ text: systemPrompt }, { text: `Raw Input: \"${text}\"` }],\n            },\n          ],\n          generationConfig: { responseMimeType: \"application/json\" },\n        }),\n      }\n    );\n\n    if (!response.ok) throw new Error(\"AI Request Failed\");\n    const data = await response.json();\n    let resultText = data.candidates?.[0]?.content?.parts?.[0]?.text;\n\n    // Robust parsing\n    const firstBrace = resultText.indexOf(\"{\");\n    const lastBrace = resultText.lastIndexOf(\"}\");\n    if (firstBrace !== -1 && lastBrace !== -1) {\n      resultText = resultText.substring(firstBrace, lastBrace + 1);\n    }\n\n    const parsedData = JSON.parse(resultText);\n    const notesRaw = Array.isArray(parsedData.notes)\n      ? parsedData.notes\n      : [parsedData];\n\n    return notesRaw.map((n) => {\n      let cleanSummary = \"\";\n      if (typeof n.summary === \"string\") {\n        cleanSummary = n.summary;\n      } else if (Array.isArray(n.summary)) {\n        cleanSummary = n.summary.join(\"\\n\");\n      } else {\n        cleanSummary = JSON.stringify(n.summary || \"\");\n      }\n\n      return {\n        title: typeof n.title === \"string\" ? n.title : \"à¹„à¸¡à¹ˆà¸¡à¸µà¸Šà¸·à¹ˆà¸­à¹€à¸£à¸·à¹ˆà¸­à¸‡\",\n        category: typeof n.category === \"string\" ? n.category : \"à¸—à¸±à¹ˆà¸§à¹„à¸›\",\n        summary: cleanSummary,\n      };\n    });\n  } catch (error) {\n    console.error(\"AI Error:\", error);\n    return [\n      {\n        title: \"à¸šà¸±à¸™à¸—à¸¶à¸à¸‰à¸šà¸±à¸šà¸£à¹ˆà¸²à¸‡ (AI à¸‚à¸±à¸”à¸‚à¹‰à¸­à¸‡)\",\n        summary: \"ðŸ“Œ à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹€à¸”à¸´à¸¡\\n- \" + text,\n        category: \"à¸—à¸±à¹ˆà¸§à¹„à¸›\",\n      },\n    ];\n  }\n};\n\nconst formatDateThai = (timestamp) => {\n  if (!timestamp) return \"\";\n  try {\n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\n    if (isNaN(date.getTime())) return \"\";\n    return date.toLocaleDateString(\"th-TH\", {\n      day: \"numeric\",\n      month: \"short\",\n      year: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n    });\n  } catch (e) {\n    return \"\";\n  }\n};\n\nconst formatTimeThai = (timestamp) => {\n  if (!timestamp) return \"\";\n  try {\n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\n    if (isNaN(date.getTime())) return \"\";\n    return date.toLocaleTimeString(\"th-TH\", {\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n    });\n  } catch (e) {\n    return \"\";\n  }\n};\n\nconst toDateTimeLocal = (timestamp) => {\n  if (!timestamp) return \"\";\n  try {\n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\n    if (isNaN(date.getTime())) return \"\";\n    const tzOffset = date.getTimezoneOffset() * 60000;\n    return new Date(date - tzOffset).toISOString().slice(0, 16);\n  } catch (e) {\n    return \"\";\n  }\n};\n\n// --- Components ---\n\nconst AccessScreen = ({ onJoin }) => {\n  const [code, setCode] = useState(\"\");\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (code.trim()) {\n      onJoin(code.trim());\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 flex flex-col items-center justify-center p-4 font-sans\">\n      <div className=\"bg-white p-8 rounded-3xl shadow-xl w-full max-w-md text-center border border-slate-100\">\n        <div className=\"w-16 h-16 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mx-auto mb-6\">\n          <KeyRound size={32} />\n        </div>\n        <h1 className=\"text-2xl font-bold text-slate-800 mb-2\">\n          à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸«à¹‰à¸­à¸‡à¸—à¸³à¸‡à¸²à¸™\n        </h1>\n        <p className=\"text-slate-500 mb-6 text-sm\">\n          à¸à¸£à¸­à¸à¸Šà¸·à¹ˆà¸­à¸«à¹‰à¸­à¸‡à¹€à¸žà¸·à¹ˆà¸­à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¸­à¸‡à¸„à¸¸à¸“\n          <br />\n          (à¹€à¸Šà¹ˆà¸™ \"Zoom2026\")\n        </p>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <input\n            type=\"text\"\n            value={code}\n            onChange={(e) => setCode(e.target.value)}\n            placeholder=\"à¸•à¸±à¹‰à¸‡à¸Šà¸·à¹ˆà¸­à¸«à¹‰à¸­à¸‡ à¸«à¸£à¸·à¸­ à¹ƒà¸ªà¹ˆà¸£à¸«à¸±à¸ª...\"\n            className=\"w-full px-4 py-3 text-center text-lg border-2 border-slate-200 rounded-xl focus:border-indigo-500 focus:outline-none transition-colors\"\n            autoFocus\n          />\n          <button\n            type=\"submit\"\n            disabled={!code.trim()}\n            className=\"w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-indigo-200\"\n          >\n            à¹€à¸‚à¹‰à¸²à¹ƒà¸Šà¹‰à¸‡à¸²à¸™\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nconst ConfigScreen = () => (\n  <div className=\"min-h-screen flex items-center justify-center bg-slate-100 p-4 font-sans\">\n    <div className=\"bg-white p-8 rounded-xl shadow-lg max-w-lg text-center\">\n      <div className=\"mx-auto bg-red-100 w-16 h-16 rounded-full flex items-center justify-center mb-4 text-red-500\">\n        <AlertCircle size={32} />\n      </div>\n      <h1 className=\"text-xl font-bold text-red-500 mb-4\">\n        à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Firebase\n      </h1>\n      <p className=\"text-slate-600 mb-4 leading-relaxed\">\n        à¸à¸£à¸¸à¸“à¸²à¹à¸à¹‰à¹„à¸‚à¹„à¸Ÿà¸¥à¹Œ <code>App.jsx</code> à¹à¸¥à¸°à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²{\" \"}\n        <code>firebaseConfig</code> (à¸ˆà¸²à¸ Firebase) à¹à¸¥à¸°{\" \"}\n        <code>GEMINI_API_KEY</code> (à¸ˆà¸²à¸ AI Studio) à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸«à¹‰à¹à¸­à¸žà¸—à¸³à¸‡à¸²à¸™à¹„à¸”à¹‰à¸„à¸£à¸±à¸š\n      </p>\n      <p className=\"text-sm text-slate-400\">\n        (à¸”à¸¹à¸§à¸´à¸˜à¸µà¸à¸²à¸£à¹ƒà¸™à¹„à¸Ÿà¸¥à¹Œà¸„à¸¹à¹ˆà¸¡à¸·à¸­à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¸—à¸µà¹ˆà¸œà¸¡à¹ƒà¸«à¹‰à¹„à¸›à¸„à¸£à¸±à¸š)\n      </p>\n    </div>\n  </div>\n);\n\nconst FormattedText = ({ text }) => {\n  if (!text) return null;\n\n  let content = text;\n  if (typeof text !== \"string\") {\n    if (Array.isArray(text)) content = text.join(\"\\n\");\n    else if (typeof text === \"object\") content = JSON.stringify(text);\n    else content = String(text);\n  }\n\n  return (\n    <div className=\"space-y-1\">\n      {content.split(\"\\n\").map((line, index) => {\n        const trimmed = line.trim();\n        if (!trimmed) return <div key={index} className=\"h-2\"></div>;\n\n        const isHeader =\n          trimmed.startsWith(\"ðŸ“Œ\") ||\n          trimmed.startsWith(\"ðŸ“\") ||\n          trimmed.match(/^à¸«à¸±à¸§à¸‚à¹‰à¸­/);\n        const isNumberList = trimmed.match(/^\\d+\\./);\n        const isBullet =\n          trimmed.startsWith(\"-\") ||\n          trimmed.startsWith(\"â€¢\") ||\n          trimmed.startsWith(\"*\");\n\n        return (\n          <div\n            key={index}\n            className={`\n            ${isHeader\n                ? \"font-bold text-indigo-900 mt-4 mb-2 text-base\"\n                : \"text-slate-600\"\n              } \n            ${isNumberList || isBullet ? \"pl-4\" : \"pl-0\"}\n            leading-relaxed\n          `}\n          >\n            {line}\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nconst FullScreenEditor = ({ note, onClose, onSave, categoriesList }) => {\n  const [title, setTitle] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  const [category, setCategory] = useState(\"à¸—à¸±à¹ˆà¸§à¹„à¸›\");\n  const [createdAt, setCreatedAt] = useState(\"\");\n  const [isEditingCategory, setIsEditingCategory] = useState(false);\n  const [tempCategoryName, setTempCategoryName] = useState(\"\");\n\n  useEffect(() => {\n    if (note) {\n      setTitle(typeof note.title === \"string\" ? note.title : \"\");\n      let safeContent = \"\";\n      if (typeof note.summary === \"string\") safeContent = note.summary;\n      else if (Array.isArray(note.summary))\n        safeContent = note.summary.join(\"\\n\");\n      else safeContent = JSON.stringify(note.summary || \"\");\n\n      setContent(safeContent);\n      setCategory(typeof note.category === \"string\" ? note.category : \"à¸—à¸±à¹ˆà¸§à¹„à¸›\");\n      setCreatedAt(toDateTimeLocal(note.createdAt));\n    }\n  }, [note]);\n\n  const handleSave = () => {\n    let timestamp = note.createdAt;\n    if (createdAt) {\n      try {\n        timestamp = Timestamp.fromDate(new Date(createdAt));\n      } catch (e) {\n        console.error(\"Invalid date\");\n      }\n    }\n\n    onSave(note.id, {\n      title,\n      summary: content,\n      category,\n      createdAt: timestamp,\n    });\n    onClose();\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 bg-white/95 backdrop-blur-sm flex items-center justify-center p-4 animate-in fade-in zoom-in-95 duration-200 font-sans\">\n      <div className=\"bg-white w-full max-w-4xl h-[95vh] rounded-3xl shadow-2xl border border-slate-200 flex flex-col overflow-hidden\">\n        <div className=\"px-6 py-4 border-b flex justify-between items-center bg-slate-50\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"bg-indigo-100 p-2 rounded-lg text-indigo-600\">\n              <Maximize2 size={20} />\n            </div>\n            <div>\n              <h2 className=\"font-bold text-slate-800\">à¹à¸à¹‰à¹„à¸‚à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸šà¸šà¹€à¸•à¹‡à¸¡à¸ˆà¸­</h2>\n              <p className=\"text-xs text-slate-500\">\n                {note.history?.length > 0\n                  ? `à¹à¸à¹‰à¹„à¸‚à¹à¸¥à¹‰à¸§ ${note.history.length} à¸„à¸£à¸±à¹‰à¸‡`\n                  : \"à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸à¸²à¸£à¹à¸à¹‰à¹„à¸‚\"}\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-slate-200 rounded-full text-slate-500\"\n          >\n            <Minimize2 size={24} />\n          </button>\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto p-8 space-y-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div>\n              <label className=\"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block\">\n                à¸§à¸±à¸™à¸—à¸µà¹ˆà¹à¸¥à¸°à¹€à¸§à¸¥à¸²à¸šà¸±à¸™à¸—à¸¶à¸\n              </label>\n              <div className=\"flex items-center gap-2 bg-slate-50 p-2 rounded-xl border border-slate-200 focus-within:ring-2 focus-within:ring-indigo-100\">\n                <Calendar size={18} className=\"text-slate-400 ml-2\" />\n                <input\n                  type=\"datetime-local\"\n                  value={createdAt}\n                  onChange={(e) => setCreatedAt(e.target.value)}\n                  className=\"bg-transparent border-none focus:outline-none text-slate-700 w-full font-medium\"\n                />\n              </div>\n            </div>\n\n            <div>\n              <label className=\"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block\">\n                à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ (à¹à¸à¹‰à¹„à¸‚à¸Šà¸·à¹ˆà¸­à¹„à¸”à¹‰)\n              </label>\n\n              {isEditingCategory ? (\n                <div className=\"flex items-center gap-2 h-[42px]\">\n                  <input\n                    value={tempCategoryName}\n                    onChange={(e) => setTempCategoryName(e.target.value)}\n                    className=\"flex-1 border border-indigo-300 rounded-lg px-3 py-2 text-sm focus:outline-indigo-500\"\n                    placeholder=\"à¸žà¸´à¸¡à¸žà¹Œà¸Šà¸·à¹ˆà¸­à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ...\"\n                    autoFocus\n                    onKeyDown={(e) => {\n                      if (e.key === \"Enter\") {\n                        if (tempCategoryName.trim())\n                          setCategory(tempCategoryName.trim());\n                        setIsEditingCategory(false);\n                      }\n                    }}\n                  />\n                  <button\n                    onClick={() => {\n                      if (tempCategoryName.trim())\n                        setCategory(tempCategoryName.trim());\n                      setIsEditingCategory(false);\n                    }}\n                    className=\"p-2 bg-green-500 text-white rounded-lg hover:bg-green-600\"\n                  >\n                    <Check size={16} />\n                  </button>\n                  <button\n                    onClick={() => setIsEditingCategory(false)}\n                    className=\"p-2 bg-slate-200 text-slate-500 rounded-lg hover:bg-slate-300\"\n                  >\n                    <X size={16} />\n                  </button>\n                </div>\n              ) : (\n                <div className=\"flex flex-col gap-2\">\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"flex items-center justify-between gap-3 bg-indigo-50 border border-indigo-200 text-indigo-700 px-3 py-2 rounded-lg font-medium text-sm w-full md:w-auto min-w-[150px]\">\n                      <span>{category}</span>\n                      <button\n                        onClick={() => {\n                          setTempCategoryName(category);\n                          setIsEditingCategory(true);\n                        }}\n                        className=\"hover:bg-indigo-200 rounded p-1 text-indigo-400 hover:text-indigo-700 transition-colors\"\n                        title=\"à¹à¸à¹‰à¹„à¸‚à¸Šà¸·à¹ˆà¸­à¸«à¸¡à¸§à¸”à¸«à¸¡à¸¹à¹ˆ\"\n                      >\n                        <Pencil size={14} />\n                      </button>\n                    </div>\n                  </div>\n\n                  <div className=\"flex gap-2 flex-wrap mt-1\">\n                    {categoriesList\n                      .filter((c) => c !== category)\n                      .slice(0, 5)\n                      .map((cat) => (\n                        <button\n                          key={cat}\n                          onClick={() => setCategory(cat)}\n                          className=\"px-2 py-1 rounded text-xs bg-slate-100 text-slate-500 hover:bg-slate-200 transition-colors border border-transparent\"\n                        >\n                          {cat}\n                        </button>\n                      ))}\n                    <button\n                      onClick={() => {\n                        setTempCategoryName(\"\");\n                        setIsEditingCategory(true);\n                      }}\n                      className=\"px-2 py-1 rounded text-xs border border-dashed border-slate-300 text-slate-400 hover:text-indigo-600 hover:border-indigo-400 flex items-center gap-1\"\n                    >\n                      <Plus size={10} /> à¹€à¸žà¸´à¹ˆà¸¡à¹ƒà¸«à¸¡à¹ˆ\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          <hr className=\"border-slate-100\" />\n\n          <div>\n            <label className=\"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block\">\n              à¸«à¸±à¸§à¸‚à¹‰à¸­à¹€à¸£à¸·à¹ˆà¸­à¸‡\n            </label>\n            <input\n              value={title}\n              onChange={(e) => setTitle(e.target.value)}\n              className=\"w-full text-3xl font-bold text-slate-900 border-b-2 border-slate-100 focus:border-indigo-500 focus:outline-none pb-2 placeholder-slate-300 transition-colors\"\n              placeholder=\"à¹ƒà¸ªà¹ˆà¸Šà¸·à¹ˆà¸­à¹€à¸£à¸·à¹ˆà¸­à¸‡...\"\n            />\n          </div>\n\n          <div className=\"h-full\">\n            <label className=\"text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2 block\">\n              à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸” (1. 2. 3. à¸«à¸£à¸·à¸­ -)\n            </label>\n            <textarea\n              value={content}\n              onChange={(e) => setContent(e.target.value)}\n              className=\"w-full h-[400px] text-lg text-slate-700 leading-relaxed resize-none focus:outline-none p-4 -ml-4 rounded-xl border border-transparent focus:border-slate-100 focus:bg-slate-50 transition-all font-sans\"\n              placeholder=\"à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”...\"\n            />\n          </div>\n        </div>\n\n        <div className=\"px-6 py-4 border-t bg-slate-50 flex justify-end gap-3\">\n          <button\n            onClick={onClose}\n            className=\"px-6 py-2.5 rounded-xl text-slate-500 hover:bg-slate-200 font-medium transition-colors\"\n          >\n            à¸¢à¸à¹€à¸¥à¸´à¸\n          </button>\n          <button\n            onClick={handleSave}\n            className=\"px-6 py-2.5 rounded-xl bg-indigo-600 text-white shadow-lg shadow-indigo-200 hover:bg-indigo-700 font-medium transition-all flex items-center gap-2\"\n          >\n            <Save size={18} /> à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸¥à¸°à¸ªà¸³à¸£à¸­à¸‡à¸›à¸£à¸°à¸§à¸±à¸•à¸´\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst NoteCard = ({ note, onEdit, onDelete, onExpand }) => {\n  const [isEditing, setIsEditing] = useState(false);\n  const [editedTitle, setEditedTitle] = useState(\"\");\n  const [editedContent, setEditedContent] = useState(\"\");\n\n  useEffect(() => {\n    setEditedTitle(typeof note.title === \"string\" ? note.title : \"\");\n    let safeContent = \"\";\n    if (typeof note.summary === \"string\") safeContent = note.summary;\n    else if (Array.isArray(note.summary)) safeContent = note.summary.join(\"\\n\");\n    else safeContent = JSON.stringify(note.summary || \"\");\n    setEditedContent(safeContent);\n  }, [note]);\n\n  const handleQuickSave = () => {\n    onEdit(note.id, { title: editedTitle, summary: editedContent });\n    setIsEditing(false);\n  };\n\n  const categoryColors = {\n    à¸›à¸£à¸°à¸Šà¸¸à¸¡: \"bg-blue-50 border-blue-200 text-blue-700\",\n    à¸à¸²à¸£à¹€à¸‡à¸´à¸™: \"bg-green-50 border-green-200 text-green-700\",\n    à¹„à¸­à¹€à¸”à¸µà¸¢à¸˜à¸¸à¸£à¸à¸´à¸ˆ: \"bg-amber-50 border-amber-200 text-amber-700\",\n    à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§: \"bg-pink-50 border-pink-200 text-pink-700\",\n    à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§: \"bg-purple-50 border-purple-200 text-purple-700\",\n    à¸ªà¸¸à¸‚à¸ à¸²à¸ž: \"bg-teal-50 border-teal-200 text-teal-700\",\n    à¸—à¸±à¹ˆà¸§à¹„à¸›: \"bg-gray-50 border-gray-200 text-gray-700\",\n  };\n\n  const themeClass =\n    categoryColors[note.category] ||\n    \"bg-indigo-50 border-indigo-200 text-indigo-700\";\n\n  return (\n    <div\n      className={`group relative flex flex-col p-5 rounded-2xl border bg-white transition-all duration-300 hover:-translate-y-1 hover:shadow-lg ${isEditing ? \"z-10 ring-2 ring-indigo-500\" : \"\"\n        }`}\n    >\n      <div className=\"flex justify-between items-start mb-3\">\n        <span\n          className={`text-[10px] uppercase tracking-wide font-bold px-2.5 py-1 rounded-md border ${themeClass}`}\n        >\n          {typeof note.category === \"string\" ? note.category : \"à¸—à¸±à¹ˆà¸§à¹„à¸›\"}\n        </span>\n\n        <div className=\"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              onExpand(note);\n            }}\n            className=\"p-1.5 hover:bg-indigo-50 hover:text-indigo-600 rounded-full text-gray-400 transition-colors\"\n            title=\"à¸”à¸¹à¹€à¸•à¹‡à¸¡à¸ˆà¸­\"\n          >\n            <Maximize2 size={16} />\n          </button>\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              setIsEditing(!isEditing);\n            }}\n            className=\"p-1.5 hover:bg-gray-100 rounded-full text-gray-400 transition-colors\"\n            title=\"à¹à¸à¹‰à¹„à¸‚à¸”à¹ˆà¸§à¸™\"\n          >\n            <Pencil size={16} />\n          </button>\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              onDelete(note.id);\n            }}\n            className=\"p-1.5 hover:bg-red-50 hover:text-red-500 rounded-full text-gray-400 transition-colors\"\n            title=\"à¸¥à¸š\"\n          >\n            <Trash2 size={16} />\n          </button>\n        </div>\n      </div>\n\n      <div className=\"space-y-3 flex-1\">\n        {isEditing ? (\n          <div onClick={(e) => e.stopPropagation()}>\n            <input\n              value={editedTitle}\n              onChange={(e) => setEditedTitle(e.target.value)}\n              className=\"w-full font-bold text-gray-900 text-lg border-b pb-1 focus:outline-none focus:border-indigo-500\"\n            />\n            <textarea\n              value={editedContent}\n              onChange={(e) => setEditedContent(e.target.value)}\n              className=\"w-full text-sm text-gray-700 resize-none focus:outline-none bg-gray-50 p-2 rounded-lg border border-transparent focus:border-indigo-200 font-sans\"\n              rows={6}\n            />\n            <div className=\"flex justify-end gap-2 mt-2\">\n              <button\n                onClick={() => setIsEditing(false)}\n                className=\"px-3 py-1 text-xs text-gray-500\"\n              >\n                à¸¢à¸à¹€à¸¥à¸´à¸\n              </button>\n              <button\n                onClick={handleQuickSave}\n                className=\"px-3 py-1 text-xs bg-indigo-600 text-white rounded-md\"\n              >\n                à¸šà¸±à¸™à¸—à¸¶à¸\n              </button>\n            </div>\n          </div>\n        ) : (\n          <div onClick={() => onExpand(note)} className=\"cursor-pointer\">\n            <h3 className=\"font-bold text-gray-900 text-lg mb-2 leading-tight hover:text-indigo-700 transition-colors\">\n              {typeof note.title === \"string\" ? note.title : \"à¹„à¸¡à¹ˆà¸¡à¸µà¸«à¸±à¸§à¸‚à¹‰à¸­\"}\n            </h3>\n            <div className=\"text-sm line-clamp-6\">\n              <FormattedText text={note.summary} />\n            </div>\n          </div>\n        )}\n      </div>\n\n      {!isEditing && (\n        <div className=\"mt-5 pt-3 border-t border-gray-100 flex items-center justify-between text-xs text-gray-400 font-medium\">\n          <div className=\"flex items-center gap-1\">\n            <Calendar size={12} />\n            {formatDateThai(note.createdAt)}\n          </div>\n          <div className=\"flex items-center gap-1\">\n            <Clock size={12} />\n            {formatTimeThai(note.createdAt)}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default function SmartNoteApp() {\n  // --- All hooks must be called first, before any conditional returns ---\n  const [user, setUser] = useState(null);\n  const [accessCode, setAccessCode] = useState(\n    () => localStorage.getItem(\"zoom_note_access_code\") || \"\"\n  );\n  const [inputMode, setInputMode] = useState(false);\n  const [rawText, setRawText] = useState(\"\");\n  const [notes, setNotes] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedCategory, setSelectedCategory] = useState(\"à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”\");\n  const [selectedDate, setSelectedDate] = useState(\"\");\n  const [expandedNote, setExpandedNote] = useState(null);\n\n  const baseCategories = [\n    \"à¸›à¸£à¸°à¸Šà¸¸à¸¡\",\n    \"à¸à¸²à¸£à¹€à¸‡à¸´à¸™\",\n    \"à¹„à¸­à¹€à¸”à¸µà¸¢à¸˜à¸¸à¸£à¸à¸´à¸ˆ\",\n    \"à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§\",\n    \"à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§\",\n    \"à¸ªà¸¸à¸‚à¸ à¸²à¸ž\",\n    \"à¸—à¸±à¹ˆà¸§à¹„à¸›\",\n  ];\n  const categoriesList = useMemo(() => {\n    const noteCategories = notes\n      .map((n) => n.category)\n      .filter((c) => typeof c === \"string\");\n    return [...new Set([...baseCategories, ...noteCategories])];\n  }, [notes]);\n\n  // --- Auto-inject Tailwind for CodeSandbox ---\n  useEffect(() => {\n    if (!document.getElementById(\"tailwind-script\")) {\n      const script = document.createElement(\"script\");\n      script.src = \"https://cdn.tailwindcss.com\";\n      script.id = \"tailwind-script\";\n      document.head.appendChild(script);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!isConfigured) return;\n\n    const initAuth = async () => {\n      await signInAnonymously(auth);\n    };\n    initAuth();\n    const unsubscribe = onAuthStateChanged(auth, setUser);\n    return () => unsubscribe();\n  }, []);\n\n  // Sync Access Code to Public Collection\n  useEffect(() => {\n    if (!isConfigured || !user || !accessCode) {\n      if (!accessCode) setLoading(false);\n      return;\n    }\n\n    setLoading(true);\n    // Use PUBLIC path with accessCode as a key\n    const collectionPath = `smart_notes_shared_${accessCode.replace(\n      /[^a-zA-Z0-9]/g,\n      \"_\"\n    )}`;\n\n    const q = query(\n      collection(db, \"artifacts\", appId, \"public\", \"data\", collectionPath),\n      orderBy(\"createdAt\", \"desc\")\n    );\n\n    const unsubscribe = onSnapshot(\n      q,\n      (snapshot) => {\n        const notesData = snapshot.docs.map((doc) => ({\n          id: doc.id,\n          ...doc.data(),\n        }));\n        setNotes(notesData);\n        setLoading(false);\n      },\n      (error) => {\n        console.error(error);\n        setLoading(false);\n      }\n    );\n\n    return () => unsubscribe();\n  }, [user, accessCode]);\n\n  const handleJoinSpace = (code) => {\n    setAccessCode(code);\n    localStorage.setItem(\"zoom_note_access_code\", code);\n  };\n\n  const handleLogoutSpace = () => {\n    setAccessCode(\"\");\n    localStorage.removeItem(\"zoom_note_access_code\");\n    setNotes([]);\n  };\n\n  const getCollectionPath = () => {\n    return `smart_notes_shared_${accessCode.replace(/[^a-zA-Z0-9]/g, \"_\")}`;\n  };\n\n  const handleProcessNote = async () => {\n    if (!rawText.trim()) return;\n    setIsProcessing(true);\n    const notesArray = await callGeminiAI(rawText);\n    try {\n      const colPath = getCollectionPath();\n      const promises = notesArray.map((noteData) =>\n        addDoc(collection(db, \"artifacts\", appId, \"public\", \"data\", colPath), {\n          ...noteData,\n          rawContent: rawText,\n          createdAt: serverTimestamp(),\n          isProcessed: true,\n          history: [],\n          createdBy: user.uid,\n        })\n      );\n      await Promise.all(promises);\n      setRawText(\"\");\n      setInputMode(false);\n    } catch (error) {\n      console.error(error);\n      alert(\"à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”à¹ƒà¸™à¸à¸²à¸£à¸šà¸±à¸™à¸—à¸¶à¸\");\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const handleUpdateNote = async (id, newData) => {\n    try {\n      const oldNote = notes.find((n) => n.id === id);\n      if (!oldNote) return;\n\n      const historySnapshot = {\n        title: oldNote.title,\n        summary: oldNote.summary,\n        category: oldNote.category,\n        editedAt: new Date().toISOString(),\n      };\n\n      const colPath = getCollectionPath();\n      await updateDoc(\n        doc(db, \"artifacts\", appId, \"public\", \"data\", colPath, id),\n        {\n          ...newData,\n          history: arrayUnion(historySnapshot),\n        }\n      );\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  const handleDeleteNote = async (id) => {\n    if (window.confirm(\"à¸„à¸¸à¸“à¹à¸™à¹ˆà¹ƒà¸ˆà¸§à¹ˆà¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸¥à¸šà¸šà¸±à¸™à¸—à¸¶à¸à¸™à¸µà¹‰? (à¸¥à¸šà¹à¸¥à¹‰à¸§à¸à¸¹à¹‰à¸„à¸·à¸™à¹„à¸¡à¹ˆà¹„à¸”à¹‰)\")) {\n      try {\n        const colPath = getCollectionPath();\n        await deleteDoc(\n          doc(db, \"artifacts\", appId, \"public\", \"data\", colPath, id)\n        );\n      } catch (error) {\n        console.error(error);\n      }\n    }\n  };\n\n  const filteredNotes = useMemo(() => {\n    return notes.filter((note) => {\n      const safeTitle = typeof note.title === \"string\" ? note.title : \"\";\n      const safeSummary = typeof note.summary === \"string\" ? note.summary : \"\";\n\n      const matchesSearch = (safeTitle + safeSummary)\n        .toLowerCase()\n        .includes(searchQuery.toLowerCase());\n      const matchesCategory =\n        selectedCategory === \"à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”\" || note.category === selectedCategory;\n\n      let matchesDate = true;\n      if (selectedDate && note.createdAt) {\n        try {\n          const noteDate = note.createdAt.toDate\n            ? note.createdAt.toDate()\n            : new Date(note.createdAt);\n          const noteDateString = noteDate.toISOString().split(\"T\")[0];\n          matchesDate = noteDateString === selectedDate;\n        } catch (e) {\n          matchesDate = false;\n        }\n      }\n\n      return matchesSearch && matchesCategory && matchesDate;\n    });\n  }, [notes, searchQuery, selectedCategory, selectedDate]);\n\n  // --- Now conditional returns are safe ---\n  if (!isConfigured) return <ConfigScreen />;\n\n  if (!accessCode) {\n    return (\n      <>\n        <AccessScreen onJoin={handleJoinSpace} />\n      </>\n    );\n  }\n\n  if (loading)\n    return (\n      <div className=\"h-screen flex items-center justify-center text-indigo-600 bg-white font-sans\">\n        <Loader2 className=\"animate-spin mr-2\" /> à¸à¸³à¸¥à¸±à¸‡à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸«à¹‰à¸­à¸‡ {accessCode}\n        ...\n      </div>\n    );\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 text-slate-800 font-sans\">\n      {expandedNote && (\n        <FullScreenEditor\n          note={expandedNote}\n          onClose={() => setExpandedNote(null)}\n          onSave={handleUpdateNote}\n          categoriesList={categoriesList}\n        />\n      )}\n\n      <header className=\"sticky top-0 z-30 bg-white/90 backdrop-blur-xl border-b border-slate-200 px-6 py-4 flex items-center justify-between shadow-sm\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"bg-indigo-600 text-white p-2 rounded-xl shadow-lg shadow-indigo-200\">\n            <Bot size={24} />\n          </div>\n          <div>\n            <h1 className=\"font-bold text-xl text-slate-900 tracking-tight flex items-center gap-2\">\n              {accessCode}\n              <span className=\"text-xs bg-indigo-100 text-indigo-600 px-2 py-0.5 rounded-full font-normal\">\n                Shared Space\n              </span>\n            </h1>\n            <p className=\"text-xs font-medium text-slate-500\">\n              à¹€à¸¥à¸‚à¸²à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸‹à¸¹à¸¡\n            </p>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          {!inputMode && (\n            <button\n              onClick={() => setInputMode(true)}\n              className=\"bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2.5 rounded-full shadow-lg shadow-indigo-300/50 flex items-center gap-2 transition-all active:scale-95 transform hover:-translate-y-0.5\"\n            >\n              <Plus size={20} />{\" \"}\n              <span className=\"hidden sm:inline font-medium\">à¸ˆà¸”à¸šà¸±à¸™à¸—à¸¶à¸</span>\n            </button>\n          )}\n          <button\n            onClick={handleLogoutSpace}\n            className=\"bg-slate-100 hover:bg-slate-200 text-slate-600 p-2.5 rounded-full transition-colors\"\n            title=\"à¸­à¸­à¸à¸ˆà¸²à¸à¸«à¹‰à¸­à¸‡\"\n          >\n            <LogOut size={20} />\n          </button>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto p-4 md:p-8\">\n        {inputMode ? (\n          <div className=\"max-w-3xl mx-auto animate-in fade-in slide-in-from-bottom-8 duration-500\">\n            <div className=\"flex gap-4 mb-6\">\n              <div className=\"w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center flex-shrink-0\">\n                <Bot size={20} className=\"text-indigo-600\" />\n              </div>\n              <div className=\"bg-white p-4 rounded-2xl rounded-tl-none shadow-sm border border-slate-100 text-slate-700\">\n                <p>\n                  à¸žà¸£à¹‰à¸­à¸¡à¸„à¸£à¸±à¸š! à¸žà¸´à¸¡à¸žà¹Œà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸”à¸´à¸šà¸¡à¸²à¹„à¸”à¹‰à¹€à¸¥à¸¢\n                  à¹€à¸”à¸µà¹‹à¸¢à¸§à¸œà¸¡à¹à¸¢à¸à¸«à¸±à¸§à¸‚à¹‰à¸­à¹ƒà¸«à¹‰à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ (à¸šà¸±à¸™à¸—à¸¶à¸à¸™à¸µà¹‰à¸ˆà¸°à¹€à¸«à¹‡à¸™à¸—à¸¸à¸à¸„à¸™à¹ƒà¸™à¸«à¹‰à¸­à¸‡{\" \"}\n                  <b>{accessCode}</b> à¸„à¸£à¸±à¸š)\n                </p>\n              </div>\n            </div>\n\n            <div className=\"bg-white rounded-3xl shadow-xl shadow-slate-200/50 overflow-hidden border border-slate-100 relative\">\n              <div className=\"absolute top-4 right-4 z-10\">\n                <button\n                  onClick={() => !isProcessing && setInputMode(false)}\n                  className=\"p-2 hover:bg-slate-100 rounded-full text-slate-400 hover:text-slate-600 transition-colors\"\n                >\n                  <X size={20} />\n                </button>\n              </div>\n\n              <textarea\n                value={rawText}\n                onChange={(e) => setRawText(e.target.value)}\n                disabled={isProcessing}\n                placeholder=\"à¸žà¸´à¸¡à¸žà¹Œà¸—à¸µà¹ˆà¸™à¸µà¹ˆ...\"\n                className=\"w-full h-[320px] p-6 text-lg text-slate-700 placeholder:text-slate-300 resize-none focus:outline-none leading-relaxed\"\n                autoFocus\n              />\n\n              <div className=\"p-4 bg-slate-50 border-t border-slate-100 flex justify-between items-center\">\n                <span className=\"text-xs text-slate-400 pl-2\">\n                  {rawText.length > 0\n                    ? `${rawText.length} à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£`\n                    : \"à¸£à¸­à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥...\"}\n                </span>\n\n                <button\n                  onClick={handleProcessNote}\n                  disabled={!rawText.trim() || isProcessing}\n                  className=\"bg-indigo-600 hover:bg-indigo-700 disabled:bg-slate-300 disabled:cursor-not-allowed text-white px-6 py-3 rounded-xl font-medium shadow-lg hover:shadow-xl transition-all flex items-center gap-2 active:scale-95\"\n                >\n                  {isProcessing ? (\n                    <>\n                      <Loader2 size={18} className=\"animate-spin\" />{\" \"}\n                      à¸à¸³à¸¥à¸±à¸‡à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥...\n                    </>\n                  ) : (\n                    <>\n                      <Sparkles size={18} /> à¸ªà¸£à¸¸à¸›à¹à¸¥à¸°à¹à¸¢à¸à¸«à¸±à¸§à¸‚à¹‰à¸­à¸—à¸±à¸™à¸—à¸µ\n                    </>\n                  )}\n                </button>\n              </div>\n            </div>\n          </div>\n        ) : (\n          <div className=\"space-y-8\">\n            <div className=\"flex flex-col xl:flex-row gap-4 justify-between bg-white p-4 rounded-2xl shadow-sm border border-slate-100\">\n              <div className=\"flex flex-col sm:flex-row gap-3 w-full xl:w-auto\">\n                <div className=\"flex items-center gap-3 bg-slate-50 rounded-xl px-4 py-2.5 border border-slate-200 focus-within:ring-2 focus-within:ring-indigo-100 transition-all flex-1 sm:flex-none sm:w-64\">\n                  <Search size={18} className=\"text-slate-400\" />\n                  <input\n                    type=\"text\"\n                    placeholder=\"à¸„à¹‰à¸™à¸«à¸²...\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                    className=\"bg-transparent border-none focus:outline-none text-sm w-full text-slate-700\"\n                  />\n                </div>\n\n                <div className=\"flex items-center gap-2 bg-slate-50 rounded-xl px-4 py-2.5 border border-slate-200 text-slate-600 hover:bg-white transition-colors cursor-pointer w-full sm:w-auto\">\n                  <Calendar size={18} className=\"text-slate-400\" />\n                  <input\n                    type=\"date\"\n                    value={selectedDate}\n                    onChange={(e) => setSelectedDate(e.target.value)}\n                    className=\"bg-transparent border-none focus:outline-none text-sm text-slate-700 cursor-pointer w-full\"\n                  />\n                  {selectedDate && (\n                    <button\n                      onClick={() => setSelectedDate(\"\")}\n                      className=\"ml-2 p-1 hover:bg-slate-200 rounded-full\"\n                    >\n                      <X size={14} />\n                    </button>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"flex gap-2 overflow-x-auto pb-2 xl:pb-0 scrollbar-hide\">\n                <button\n                  onClick={() => setSelectedCategory(\"à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”\")}\n                  className={`px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-all border ${selectedCategory === \"à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”\"\n                    ? \"bg-indigo-600 text-white border-indigo-600 shadow-md\"\n                    : \"bg-white text-slate-600 border-slate-200 hover:bg-slate-50\"\n                    }`}\n                >\n                  à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”\n                </button>\n                {categoriesList.map((cat) => (\n                  <button\n                    key={cat}\n                    onClick={() => setSelectedCategory(cat)}\n                    className={`px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-all border ${selectedCategory === cat\n                      ? \"bg-indigo-600 text-white border-indigo-600 shadow-md\"\n                      : \"bg-white text-slate-600 border-slate-200 hover:bg-slate-50\"\n                      }`}\n                  >\n                    {cat}\n                  </button>\n                ))}\n              </div>\n            </div>\n\n            {filteredNotes.length === 0 ? (\n              <div className=\"text-center py-24 opacity-60\">\n                <div className=\"bg-slate-100 w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6\">\n                  <Users className=\"text-slate-400\" size={40} />\n                </div>\n                <h3 className=\"text-slate-600 font-medium text-lg\">\n                  à¸«à¹‰à¸­à¸‡à¸™à¸µà¹‰à¸¢à¸±à¸‡à¸§à¹ˆà¸²à¸‡à¸­à¸¢à¸¹à¹ˆà¸„à¸£à¸±à¸š\n                </h3>\n                <p className=\"text-slate-400 text-sm mt-2\">\n                  à¹€à¸£à¸´à¹ˆà¸¡à¸ˆà¸”à¸šà¸±à¸™à¸—à¸¶à¸à¹„à¸”à¹‰à¹€à¸¥à¸¢ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸°à¸–à¸¹à¸à¹à¸Šà¸£à¹Œà¹ƒà¸«à¹‰à¸—à¸¸à¸à¸„à¸™à¸—à¸µà¹ˆà¸¡à¸µà¸£à¸«à¸±à¸ª \"\n                  <b>{accessCode}</b>\" à¸„à¸£à¸±à¸š\n                </p>\n              </div>\n            ) : (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 auto-rows-max\">\n                {filteredNotes.map((note) => (\n                  <NoteCard\n                    key={note.id}\n                    note={note}\n                    onEdit={handleUpdateNote}\n                    onDelete={handleDeleteNote}\n                    onExpand={setExpandedNote}\n                  />\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n      </main>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}